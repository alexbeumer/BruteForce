<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>BruteForce - Voorbeeld</title>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <!-- Optional theme -->
    <link rel="stylesheet" href="css/bootstrap-theme.min.css">

    <style>
        body{
            background-color: #000;
            color: #00ff00;
            font-size: x-large;
            font-family: monoscope;
        }
        td{
            width: 33%;
        }
        .geraden{
            color: #00CC33;
        }
    </style>
</head>
<body>
<div ng-app="myApp" ng-controller="MyCtrl">
    <table class="table table-bordered">
        <tr ng-repeat="rijBruteforces in bruteforces">
            <td ng-repeat="bruteforce in rijBruteforces">
                <h1>{{bruteforce.techniek}}</h1>
                <div class="status">
                    {{bruteforce.tijdBezig}} seconden bezig en {{bruteforce.aantalPogingen}} wachtwoorden geprobeerd
                </div>
                <div class="pogingen">
                    Wachtwoorden pogingen:
                    <ul>
                        <li ng-repeat="poging in bruteforce.laatsteVijfPogingen">
                            {{$scope.woordenboek}}
                        </li>
                    </ul>
                </div>
            </td>
        </tr>
    </table>
</div>

<!-- Latest compiled and minified JavaScript -->
<script src="js/jquery.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/angular.min.js"></script>
<script>
    var app = angular.module("myApp", []);

        app.controller('MyCtrl', function($scope, $rootScope){
           $scope.woordenboek = $rootScope.woordenboek;
        });

        app.run(function($rootScope, $timeout, $q, $http){
            $rootScope.woordenboek = null;
            $http.get("resources/wordlist.txt").then(function (response) {
                $rootScope.woordenboek = response.data;
                console.log($rootScope.woordenboek);
            });
            //readTextFile("resources/wordlist.txt");
//            function readTextFile(file)
//            {
//                var rawFile = new XMLHttpRequest();
//                rawFile.open("GET", file, false);
//                rawFile.onreadystatechange = function ()
//                {
//                    if(rawFile.readyState === 4)
//                    {
//                        if(rawFile.status === 200)
//                        {
//                            var allText = rawFile.responseText;
//                            $rootScope.woordenboek = allText;
//                            console.log($rootScope.woordenboek);
//                            startBruteForcing();
//                        }
//                    }
//                }
//                rawFile.send(null);
//            }

            startBruteForcing();


            function startBruteForcing() {
                $rootScope.bruteforces = [
                    [{
                        "techniek": "alfa",
                        "wachtwoord": "password",
                        "tijdBezig": 0,
                        "aantalPogingen": 0,
                        "geraden": false,
                        "laatsteVijfPogingen": []
                    },
                        {
                            "techniek": "alfa",
                            "wachtwoord": "password123",
                            "tijdBezig": 0,
                            "aantalPogingen": 0,
                            "geraden": false,
                            "laatsteVijfPogingen": []
                        },
                        {
                            "techniek": "alfa",
                            "wachtwoord": "p4ssw0rd123",
                            "tijdBezig": 0,
                            "aantalPogingen": 0,
                            "geraden": false,
                            "laatsteVijfPogingen": []
                        },
                    ], [{
                        "techniek": "woordenboek",
                        "wachtwoord": "password",
                        "tijdBezig": 0,
                        "aantalPogingen": 0,
                        "geraden": false,
                        "laatsteVijfPogingen": []
                    },
                        {
                            "techniek": "woordenboek",
                            "wachtwoord": "password123",
                            "tijdBezig": 0,
                            "aantalPogingen": 0,
                            "geraden": false,
                            "laatsteVijfPogingen": []
                        },
                        {
                            "techniek": "woordenboek",
                            "wachtwoord": "p4ssw0rd123",
                            "tijdBezig": 0,
                            "aantalPogingen": 0,
                            "geraden": false,
                            "laatsteVijfPogingen": []
                        }
                    ]];

                for (var i = 0; i < $rootScope.bruteforces.length; i++) {
                    for (var j = 0; j < $rootScope.bruteforces[i].length; j++) {
                        var bruteforce = $rootScope.bruteforces[i][j];
                        doeEenPoging(bruteforce);
                    }
                }

                function doeEenPoging(bruteforce) {
                    if (bruteforce.geraden === false && bruteforce.aantalPogingen < 1000) {             //!!!!!!!!!!!!!Vergeet aantal pogingen < 10000 niet weg te halen!!!!!!!!!!!!!
                        bruteforce.aantalPogingen++;
                        $timeout(function () {
                            doeEenPoging(bruteforce)
                        }, 10);
                    }
                }
            };
        });
</script>
</body>
</html>